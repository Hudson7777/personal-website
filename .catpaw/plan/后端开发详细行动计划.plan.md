# åç«¯å¼€å‘è¯¦ç»†è¡ŒåŠ¨è®¡åˆ’

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**ç›®æ ‡**ï¼šå®ç°å®Œæ•´çš„åç«¯ API ç³»ç»Ÿï¼Œæ”¯æŒæ–‡ç« ã€åˆ†ç±»ã€æ ‡ç­¾ã€æ–‡ä»¶ä¸Šä¼ ç­‰åŠŸèƒ½

**æŠ€æœ¯æ ˆ**ï¼šExpress + TypeScript + Prisma + PostgreSQL

**å¼€å‘æ¨¡å¼**ï¼šåˆ†é˜¶æ®µå®ç°ï¼Œå…ˆå®Œæˆæ ¸å¿ƒåŠŸèƒ½ï¼Œå†é€æ­¥ä¼˜åŒ–

**éƒ¨ç½²æ–¹æ¡ˆ**ï¼š
- æœ¬åœ°å¼€å‘ï¼šDocker PostgreSQL
- ç”Ÿäº§ç¯å¢ƒï¼šRailway PostgreSQL + Railway Node.js

---

## ğŸ¯ å®ç°æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µï¼šæ•°æ®åº“é…ç½®å’Œåˆå§‹åŒ–

**ç›®æ ‡**ï¼šæ­å»ºæœ¬åœ°å¼€å‘æ•°æ®åº“ç¯å¢ƒï¼Œå®Œæˆ Prisma è¿ç§»

**ä»»åŠ¡**ï¼š

1. **å®‰è£…å’Œé…ç½® PostgreSQL**
   - ä½¿ç”¨ Docker å¿«é€Ÿå¯åŠ¨ PostgreSQL
   - åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
   - é…ç½® `.env` æ–‡ä»¶ä¸­çš„ `DATABASE_URL`

2. **åˆå§‹åŒ– Prisma**
   - éªŒè¯ `packages/database/prisma/schema.prisma` é…ç½®
   - è¿è¡Œ `pnpm db:push` åˆ›å»ºæ•°æ®åº“è¡¨
   - éªŒè¯æ•°æ®åº“è¿æ¥

3. **ç”Ÿæˆ Prisma Client**
   - è¿è¡Œ `pnpm db:generate`
   - ç¡®ä¿ `@prisma/client` æ­£ç¡®ç”Ÿæˆ

**æ–‡ä»¶æ¸…å•**ï¼š
- `packages/database/prisma/schema.prisma` (å·²æœ‰)
- `apps/backend/.env` (éœ€åˆ›å»º)
- `apps/backend/.env.example` (å·²æœ‰)

**å®Œæˆæ ‡å‡†**ï¼š
- âœ… PostgreSQL æœ¬åœ°è¿è¡Œ
- âœ… æ•°æ®åº“è¡¨åˆ›å»ºæˆåŠŸ
- âœ… Prisma Client ç”ŸæˆæˆåŠŸ

---

### ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒ API æ¡†æ¶æ­å»º

**ç›®æ ‡**ï¼šå»ºç«‹ Express æœåŠ¡å™¨æ¡†æ¶ï¼Œå®ç°åŸºç¡€è·¯ç”±å’Œä¸­é—´ä»¶

**ä»»åŠ¡**ï¼š

1. **å®Œå–„ Express æœåŠ¡å™¨é…ç½®**
   - æ›´æ–° `apps/backend/src/index.ts`
   - é…ç½® CORSã€JSON è§£æã€é”™è¯¯å¤„ç†ä¸­é—´ä»¶
   - å®ç°å…¨å±€é”™è¯¯å¤„ç†

2. **åˆ›å»ºè·¯ç”±ç»“æ„**
   - `apps/backend/src/routes/articles.ts` - æ–‡ç« è·¯ç”±
   - `apps/backend/src/routes/categories.ts` - åˆ†ç±»è·¯ç”±
   - `apps/backend/src/routes/tags.ts` - æ ‡ç­¾è·¯ç”±
   - `apps/backend/src/routes/upload.ts` - æ–‡ä»¶ä¸Šä¼ è·¯ç”±

3. **åˆ›å»ºæ§åˆ¶å™¨å±‚**
   - `apps/backend/src/controllers/articleController.ts`
   - `apps/backend/src/controllers/categoryController.ts`
   - `apps/backend/src/controllers/tagController.ts`
   - `apps/backend/src/controllers/uploadController.ts`

4. **åˆ›å»ºæœåŠ¡å±‚**
   - `apps/backend/src/services/articleService.ts`
   - `apps/backend/src/services/categoryService.ts`
   - `apps/backend/src/services/tagService.ts`
   - `apps/backend/src/services/uploadService.ts`

**æ–‡ä»¶æ¸…å•**ï¼š
- `apps/backend/src/index.ts` (ä¿®æ”¹)
- `apps/backend/src/routes/` (æ–°å»º)
- `apps/backend/src/controllers/` (æ–°å»º)
- `apps/backend/src/services/` (æ–°å»º)

**å®Œæˆæ ‡å‡†**ï¼š
- âœ… æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
- âœ… åŸºç¡€è·¯ç”±å¯è®¿é—®
- âœ… é”™è¯¯å¤„ç†æ­£å¸¸å·¥ä½œ

---

### ç¬¬ä¸‰é˜¶æ®µï¼šæ–‡ç«  API å®ç°

**ç›®æ ‡**ï¼šå®ç°å®Œæ•´çš„æ–‡ç«  CRUD æ“ä½œ

**ä»»åŠ¡**ï¼š

1. **å®ç°æ–‡ç« æ§åˆ¶å™¨**
   - `GET /api/articles` - è·å–æ–‡ç« åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€åˆ†ç±»ç­›é€‰ï¼‰
   - `GET /api/articles/:id` - è·å–å•ç¯‡æ–‡ç« 
   - `POST /api/articles` - åˆ›å»ºæ–‡ç« 
   - `PUT /api/articles/:id` - æ›´æ–°æ–‡ç« 
   - `DELETE /api/articles/:id` - åˆ é™¤æ–‡ç« 

2. **å®ç°æ–‡ç« æœåŠ¡**
   - æ•°æ®åº“æŸ¥è¯¢é€»è¾‘
   - ä¸šåŠ¡é€»è¾‘å¤„ç†
   - é”™è¯¯å¤„ç†

3. **æ•°æ®éªŒè¯**
   - ä½¿ç”¨ Zod éªŒè¯è¯·æ±‚æ•°æ®
   - åˆ›å»º `apps/backend/src/schemas/articleSchema.ts`

4. **API æ–‡æ¡£**
   - è®°å½• API ç«¯ç‚¹å’Œå‚æ•°

**æ–‡ä»¶æ¸…å•**ï¼š
- `apps/backend/src/controllers/articleController.ts` (æ–°å»º)
- `apps/backend/src/services/articleService.ts` (æ–°å»º)
- `apps/backend/src/schemas/articleSchema.ts` (æ–°å»º)
- `apps/backend/src/routes/articles.ts` (æ–°å»º)

**å®Œæˆæ ‡å‡†**ï¼š
- âœ… æ‰€æœ‰ CRUD æ“ä½œå¯ç”¨
- âœ… åˆ†é¡µåŠŸèƒ½æ­£å¸¸
- âœ… æ•°æ®éªŒè¯æœ‰æ•ˆ

---

### ç¬¬å››é˜¶æ®µï¼šåˆ†ç±»å’Œæ ‡ç­¾ API å®ç°

**ç›®æ ‡**ï¼šå®ç°åˆ†ç±»å’Œæ ‡ç­¾çš„ç®¡ç† API

**ä»»åŠ¡**ï¼š

1. **å®ç°åˆ†ç±» API**
   - `GET /api/categories` - è·å–æ‰€æœ‰åˆ†ç±»
   - `POST /api/categories` - åˆ›å»ºåˆ†ç±»
   - `PUT /api/categories/:id` - æ›´æ–°åˆ†ç±»
   - `DELETE /api/categories/:id` - åˆ é™¤åˆ†ç±»

2. **å®ç°æ ‡ç­¾ API**
   - `GET /api/tags` - è·å–æ‰€æœ‰æ ‡ç­¾
   - `POST /api/tags` - åˆ›å»ºæ ‡ç­¾
   - `PUT /api/tags/:id` - æ›´æ–°æ ‡ç­¾
   - `DELETE /api/tags/:id` - åˆ é™¤æ ‡ç­¾

3. **å…³è”å…³ç³»å¤„ç†**
   - æ–‡ç« ä¸åˆ†ç±»çš„å…³è”
   - æ–‡ç« ä¸æ ‡ç­¾çš„å…³è”

**æ–‡ä»¶æ¸…å•**ï¼š
- `apps/backend/src/controllers/categoryController.ts` (æ–°å»º)
- `apps/backend/src/services/categoryService.ts` (æ–°å»º)
- `apps/backend/src/routes/categories.ts` (æ–°å»º)
- `apps/backend/src/controllers/tagController.ts` (æ–°å»º)
- `apps/backend/src/services/tagService.ts` (æ–°å»º)
- `apps/backend/src/routes/tags.ts` (æ–°å»º)

**å®Œæˆæ ‡å‡†**ï¼š
- âœ… åˆ†ç±» CRUD æ­£å¸¸
- âœ… æ ‡ç­¾ CRUD æ­£å¸¸
- âœ… å…³è”å…³ç³»æ­£ç¡®

---

### ç¬¬äº”é˜¶æ®µï¼šæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½å®ç°

**ç›®æ ‡**ï¼šå®ç°å›¾ç‰‡ä¸Šä¼ å’Œç®¡ç†åŠŸèƒ½

**ä»»åŠ¡**ï¼š

1. **é…ç½®æ–‡ä»¶ä¸Šä¼ **
   - ä½¿ç”¨ Multer å¤„ç†æ–‡ä»¶ä¸Šä¼ 
   - é…ç½®ä¸Šä¼ ç›®å½•å’Œæ–‡ä»¶å¤§å°é™åˆ¶
   - åˆ›å»º `public/uploads` ç›®å½•

2. **å®ç°ä¸Šä¼  API**
   - `POST /api/upload` - ä¸Šä¼ å›¾ç‰‡
   - `DELETE /api/upload/:filename` - åˆ é™¤å›¾ç‰‡

3. **æ–‡ä»¶éªŒè¯**
   - éªŒè¯æ–‡ä»¶ç±»å‹ï¼ˆä»…å…è®¸å›¾ç‰‡ï¼‰
   - éªŒè¯æ–‡ä»¶å¤§å°
   - ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å

4. **å­˜å‚¨æœåŠ¡**
   - æœ¬åœ°å­˜å‚¨å®ç°ï¼ˆMVP é˜¶æ®µï¼‰
   - ä¸ºæœªæ¥çš„ OSS é›†æˆé¢„ç•™æ¥å£

**æ–‡ä»¶æ¸…å•**ï¼š
- `apps/backend/src/controllers/uploadController.ts` (æ–°å»º)
- `apps/backend/src/services/uploadService.ts` (æ–°å»º)
- `apps/backend/src/routes/upload.ts` (æ–°å»º)
- `apps/backend/src/middleware/upload.ts` (æ–°å»º)
- `public/uploads/` (æ–°å»ºç›®å½•)

**å®Œæˆæ ‡å‡†**ï¼š
- âœ… å›¾ç‰‡ä¸Šä¼ æˆåŠŸ
- âœ… æ–‡ä»¶éªŒè¯æœ‰æ•ˆ
- âœ… æ–‡ä»¶å¯è®¿é—®

---

### ç¬¬å…­é˜¶æ®µï¼šå‰åç«¯é›†æˆ

**ç›®æ ‡**ï¼šè¿æ¥å‰ç«¯å’Œåç«¯ï¼ŒéªŒè¯ API åŠŸèƒ½

**ä»»åŠ¡**ï¼š

1. **æ›´æ–°å‰ç«¯ API æœåŠ¡**
   - ä¿®æ”¹ `apps/frontend/src/services/articleService.ts`
   - ä¿®æ”¹ `apps/frontend/src/services/profileService.ts`
   - æ›¿æ¢ Mock æ•°æ®ä¸ºçœŸå® API è°ƒç”¨

2. **æ›´æ–°å‰ç«¯ Hooks**
   - ä¿®æ”¹ `apps/frontend/src/hooks/useArticles.ts`
   - ä¿®æ”¹ `apps/frontend/src/hooks/useArticle.ts`
   - ä¿®æ”¹ `apps/frontend/src/hooks/useProfile.ts`

3. **æµ‹è¯•é›†æˆ**
   - å¯åŠ¨å‰åç«¯æœåŠ¡
   - æµ‹è¯•æ•°æ®åŠ è½½
   - æµ‹è¯•æ–‡ä»¶ä¸Šä¼ 

4. **è°ƒè¯•å’Œä¼˜åŒ–**
   - å¤„ç† CORS é—®é¢˜
   - ä¼˜åŒ–åŠ è½½æ€§èƒ½
   - å®Œå–„é”™è¯¯å¤„ç†

**æ–‡ä»¶æ¸…å•**ï¼š
- `apps/frontend/src/services/articleService.ts` (ä¿®æ”¹)
- `apps/frontend/src/services/profileService.ts` (ä¿®æ”¹)
- `apps/frontend/src/hooks/useArticles.ts` (ä¿®æ”¹)
- `apps/frontend/src/hooks/useArticle.ts` (ä¿®æ”¹)
- `apps/frontend/src/hooks/useProfile.ts` (ä¿®æ”¹)

**å®Œæˆæ ‡å‡†**ï¼š
- âœ… å‰ç«¯èƒ½æ­£ç¡®åŠ è½½åç«¯æ•°æ®
- âœ… æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
- âœ… æ²¡æœ‰ CORS é”™è¯¯

---

### ç¬¬ä¸ƒé˜¶æ®µï¼šéƒ¨ç½²é…ç½®

**ç›®æ ‡**ï¼šé…ç½®ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

**ä»»åŠ¡**ï¼š

1. **Railway æ•°æ®åº“é…ç½®**
   - åˆ›å»º Railway PostgreSQL æ•°æ®åº“
   - è·å–æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
   - é…ç½®ç¯å¢ƒå˜é‡

2. **Railway Node.js éƒ¨ç½²**
   - è¿æ¥ GitHub ä»“åº“åˆ° Railway
   - é…ç½®æ„å»ºå‘½ä»¤
   - é…ç½®ç¯å¢ƒå˜é‡
   - è‡ªåŠ¨éƒ¨ç½²

3. **ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–**
   - é…ç½®æ—¥å¿—
   - é…ç½®é”™è¯¯ç›‘æ§
   - æ€§èƒ½ä¼˜åŒ–

**æ–‡ä»¶æ¸…å•**ï¼š
- `apps/backend/.env.production` (æ–°å»º)
- `railway.json` (å¯é€‰)

**å®Œæˆæ ‡å‡†**ï¼š
- âœ… Railway æ•°æ®åº“è¿æ¥æˆåŠŸ
- âœ… åç«¯éƒ¨ç½²æˆåŠŸ
- âœ… ç”Ÿäº§ç¯å¢ƒ API å¯è®¿é—®

---

## ğŸ“Š å®ç°é¡ºåºå’Œä¾èµ–å…³ç³»

```
ç¬¬ä¸€é˜¶æ®µï¼šæ•°æ®åº“é…ç½®
    â†“
ç¬¬äºŒé˜¶æ®µï¼šAPI æ¡†æ¶æ­å»º
    â†“
ç¬¬ä¸‰é˜¶æ®µï¼šæ–‡ç«  API
    â†“
ç¬¬å››é˜¶æ®µï¼šåˆ†ç±»å’Œæ ‡ç­¾ API
    â†“
ç¬¬äº”é˜¶æ®µï¼šæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
    â†“
ç¬¬å…­é˜¶æ®µï¼šå‰åç«¯é›†æˆ
    â†“
ç¬¬ä¸ƒé˜¶æ®µï¼šéƒ¨ç½²é…ç½®
```

---

## ğŸ› ï¸ æŠ€æœ¯ç»†èŠ‚

### æ•°æ®åº“é…ç½®

**æœ¬åœ°å¼€å‘ï¼ˆDockerï¼‰**ï¼š
```bash
docker run --name postgres -e POSTGRES_PASSWORD=password -e POSTGRES_DB=personal_website -p 5432:5432 -d postgres:15
```

**ç¯å¢ƒå˜é‡**ï¼š
```
DATABASE_URL="postgresql://postgres:password@localhost:5432/personal_website"
```

### API å“åº”æ ¼å¼

**æˆåŠŸå“åº”**ï¼š
```json
{
  "success": true,
  "data": { ... },
  "message": "Operation successful"
}
```

**é”™è¯¯å“åº”**ï¼š
```json
{
  "success": false,
  "error": "Error message",
  "message": "Detailed error description"
}
```

### æ–‡ä»¶ä¸Šä¼ é™åˆ¶

- æœ€å¤§æ–‡ä»¶å¤§å°ï¼š10MB
- å…è®¸çš„æ–‡ä»¶ç±»å‹ï¼šimage/jpeg, image/png, image/webp, image/gif
- ä¸Šä¼ ç›®å½•ï¼š`public/uploads/`

---

## ğŸ“ API ç«¯ç‚¹æ€»è§ˆ

### æ–‡ç«  API
- `GET /api/articles` - è·å–æ–‡ç« åˆ—è¡¨
- `GET /api/articles/:id` - è·å–å•ç¯‡æ–‡ç« 
- `POST /api/articles` - åˆ›å»ºæ–‡ç« 
- `PUT /api/articles/:id` - æ›´æ–°æ–‡ç« 
- `DELETE /api/articles/:id` - åˆ é™¤æ–‡ç« 

### åˆ†ç±» API
- `GET /api/categories` - è·å–æ‰€æœ‰åˆ†ç±»
- `POST /api/categories` - åˆ›å»ºåˆ†ç±»
- `PUT /api/categories/:id` - æ›´æ–°åˆ†ç±»
- `DELETE /api/categories/:id` - åˆ é™¤åˆ†ç±»

### æ ‡ç­¾ API
- `GET /api/tags` - è·å–æ‰€æœ‰æ ‡ç­¾
- `POST /api/tags` - åˆ›å»ºæ ‡ç­¾
- `PUT /api/tags/:id` - æ›´æ–°æ ‡ç­¾
- `DELETE /api/tags/:id` - åˆ é™¤æ ‡ç­¾

### æ–‡ä»¶ä¸Šä¼  API
- `POST /api/upload` - ä¸Šä¼ å›¾ç‰‡
- `DELETE /api/upload/:filename` - åˆ é™¤å›¾ç‰‡

---

## âœ… å®Œæˆæ ‡å‡†

- [ ] æ•°æ®åº“æœ¬åœ°è¿è¡Œ
- [ ] æ‰€æœ‰ API ç«¯ç‚¹å®ç°
- [ ] æ•°æ®éªŒè¯æœ‰æ•ˆ
- [ ] å‰åç«¯é›†æˆæˆåŠŸ
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æˆåŠŸ
- [ ] API æ–‡æ¡£å®Œæ•´

---

## ğŸ’¡ æ³¨æ„äº‹é¡¹

1. **åˆ†é˜¶æ®µå®ç°** - ä¸è¦ä¸€æ¬¡æ€§å®Œæˆæ‰€æœ‰åŠŸèƒ½ï¼Œé€æ­¥å®ç°ä¾¿äºæµ‹è¯•
2. **å……åˆ†æµ‹è¯•** - æ¯ä¸ªé˜¶æ®µå®Œæˆåéƒ½è¦æµ‹è¯•
3. **é”™è¯¯å¤„ç†** - å®Œå–„çš„é”™è¯¯å¤„ç†å¾ˆé‡è¦
4. **ä»£ç è´¨é‡** - éµå¾ª TypeScript æœ€ä½³å®è·µ
5. **æ–‡æ¡£è®°å½•** - è®°å½• API æ–‡æ¡£ä¾¿äºå‰ç«¯é›†æˆ

## Todos

- [ ] æ•°æ®åº“é…ç½®å’Œåˆå§‹åŒ–ï¼ˆDocker PostgreSQLã€Prisma è¿ç§»ï¼‰
- [ ] æ ¸å¿ƒ API æ¡†æ¶æ­å»ºï¼ˆExpress é…ç½®ã€è·¯ç”±ã€ä¸­é—´ä»¶ï¼‰
- [ ] æ–‡ç«  API å®ç°ï¼ˆCRUDã€åˆ†é¡µã€åˆ†ç±»ç­›é€‰ï¼‰
- [ ] åˆ†ç±»å’Œæ ‡ç­¾ API å®ç°
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½å®ç°
- [ ] å‰åç«¯é›†æˆï¼ˆæ›¿æ¢ Mock æ•°æ®ã€æµ‹è¯•åŠŸèƒ½ï¼‰
- [ ] éƒ¨ç½²é…ç½®ï¼ˆRailway æ•°æ®åº“å’Œ Node.jsï¼‰
